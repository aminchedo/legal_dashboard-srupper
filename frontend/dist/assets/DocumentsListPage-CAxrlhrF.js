import{c as f,j as e,r as g,a as w,b as k,F as b,E as j,C,f as S,S as I,T as q,d as z,e as E,g as F,h as L}from"./index-DtE9KJs9.js";const M=f("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),D=f("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function R({category:a,score:t,color:r="#3B82F6",icon:c,variant:i="filled",size:h="md"}){const l="inline-flex items-center gap-1 rounded-full font-medium",p=h==="sm"?"px-2 py-0.5 text-xs":h==="lg"?"px-4 py-1.5 text-sm":"px-3 py-1 text-sm",d=i==="filled"?{backgroundColor:`${r}1A`,color:r,border:`1px solid ${r}33`}:i==="outline"?{backgroundColor:"transparent",color:r,border:`1px solid ${r}`}:{backgroundColor:"transparent",color:r,border:"1px solid transparent"};return e.jsxs("span",{className:`${l} ${p}`,style:d,title:t?`${t}`:void 0,children:[c&&e.jsx("span",{className:"text-current",children:c}),e.jsx("span",{children:a}),typeof t<"u"&&e.jsx("span",{className:"opacity-80",children:t})]})}const T=()=>{const a=z();return E({mutationFn:t=>F.deleteDocument(t),onSuccess:()=>{a.invalidateQueries({queryKey:["documents"]}),a.invalidateQueries({queryKey:["statistics"]})}})};function $(a,t){const[r,c]=g.useState(a);return g.useEffect(()=>{const i=setTimeout(()=>{c(a)},t);return()=>{clearTimeout(i)}},[a,t]),r}function A(){const[a,t]=g.useState({query:"",category:"همه",source:"همه",page:1,limit:25}),[r,c]=g.useState(new Set),i=$(a.query,300),h=g.useMemo(()=>({...a,query:i,category:a.category==="همه"?void 0:a.category,source:a.source==="همه"?void 0:a.source}),[a,i]),{data:l,isLoading:p}=w(h),{data:d}=k(),y=T(),m=(l==null?void 0:l.items)||[],o=l==null?void 0:l.pagination,v=async s=>{if(confirm("آیا از حذف این آیتم اطمینان دارید؟"))try{await y.mutateAsync(s)}catch(n){console.error("Error deleting item:",n)}},x=(s,n)=>{t(u=>({...u,[s]:n,page:1}))},N=s=>{c(n=>{const u=new Set(n);return u.has(s)?u.delete(s):u.add(s),u})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"داده‌های جمع‌آوری شده"}),e.jsx("p",{className:"text-gray-600",children:"جستجو و مدیریت اطلاعات حقوقی جمع‌آوری شده"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"جستجو در عناوین...",value:a.query,onChange:s=>x("query",s.target.value),className:"w-full pr-10 pl-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{children:e.jsxs("select",{value:a.category,onChange:s=>x("category",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"همه",children:"همه دسته‌بندی‌ها"}),d&&Object.keys(d.categories).map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("div",{children:e.jsxs("select",{value:a.source,onChange:s=>x("source",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"همه",children:"همه منابع"}),d&&Object.keys(d.topDomains).map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("div",{children:e.jsxs("select",{value:a.limit,onChange:s=>x("limit",parseInt(s.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:25,children:"25 آیتم"}),e.jsx("option",{value:50,children:"50 آیتم"}),e.jsx("option",{value:100,children:"100 آیتم"})]})})]})}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(b,{size:20}),o&&e.jsxs("span",{children:["نمایش ",m.length.toLocaleString("fa-IR")," آیتم از ",o.totalItems.toLocaleString("fa-IR")," نتیجه"]})]})}),e.jsx("div",{className:"space-y-4",children:p?e.jsx("div",{className:"space-y-4",children:[...Array(a.limit)].map((s,n)=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]},n))}):m.length===0?e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[e.jsx(b,{size:48,className:"text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"هیچ آیتمی یافت نشد"}),e.jsx("p",{className:"text-gray-500",children:a.query?"جستجوی شما نتیجه‌ای نداشت":"هنوز آیتمی جمع‌آوری نشده است"})]}):m.map(s=>{const n=r.has(s.id);return e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{size:14}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-600 truncate max-w-48",children:s.domain})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{size:14}),e.jsx("span",{children:S(new Date(s.createdAt),"yyyy/MM/dd",{locale:L})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{size:14}),e.jsxs("span",{children:[(s.ratingScore*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"text-gray-400",children:[s.wordCount.toLocaleString("fa-IR")," کلمه"]})]}),e.jsx("div",{className:"flex items-center gap-2 mb-4",children:e.jsx(R,{category:s.category,icon:e.jsx(q,{size:14}),color:"#3B82F6",variant:"filled",size:"md"})}),e.jsxs("div",{className:"text-gray-700 leading-relaxed",children:[n?e.jsx("div",{className:"whitespace-pre-wrap",children:s.content}):e.jsxs("div",{children:[s.content.slice(0,300),s.content.length>300&&"..."]}),s.content.length>300&&e.jsx("button",{onClick:()=>N(s.id),className:"text-blue-600 hover:text-blue-700 font-medium text-sm mt-2",children:n?"نمایش کمتر":"نمایش بیشتر"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center w-10 h-10 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"مشاهده اصل",children:e.jsx(j,{size:18})}),e.jsx("button",{onClick:()=>v(s.id),className:"flex items-center justify-center w-10 h-10 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"حذف",disabled:y.isPending,children:e.jsx(D,{size:18})})]})]})},s.id)})}),o&&o.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[e.jsx("button",{onClick:()=>x("page",a.page-1),disabled:a.page===1,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg disabled:opacity-50",children:"قبلی"}),e.jsxs("span",{className:"text-gray-700",children:["صفحه ",a.page.toLocaleString("fa-IR")," از ",o.totalPages.toLocaleString("fa-IR")]}),e.jsx("button",{onClick:()=>x("page",a.page+1),disabled:a.page===o.totalPages,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg disabled:opacity-50",children:"بعدی"})]})]})}export{A as default};
