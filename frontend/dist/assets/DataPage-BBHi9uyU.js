import{r as l,I as y,j as e,a as I,b as O,R as z,h as N,f as C,i as R,e as $,c as M,d as q}from"./index-DFIyXlnM.js";import{u as E}from"./useMutation-B-WHVmSL.js";var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z"}}]},name:"calendar",theme:"outlined"};function f(){return f=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},f.apply(this,arguments)}const F=(t,a)=>l.createElement(y,f({},t,{ref:a,icon:D})),H=l.forwardRef(F);var L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};function b(){return b=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},b.apply(this,arguments)}const P=(t,a)=>l.createElement(y,b({},t,{ref:a,icon:L})),B=l.forwardRef(P);var T={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M938 458.8l-29.6-312.6c-1.5-16.2-14.4-29-30.6-30.6L565.2 86h-.4c-3.2 0-5.7 1-7.6 2.9L88.9 557.2a9.96 9.96 0 000 14.1l363.8 363.8c1.9 1.9 4.4 2.9 7.1 2.9s5.2-1 7.1-2.9l468.3-468.3c2-2.1 3-5 2.8-8zM459.7 834.7L189.3 564.3 589 164.6 836 188l23.4 247-399.7 399.7zM680 256c-48.5 0-88 39.5-88 88s39.5 88 88 88 88-39.5 88-88-39.5-88-88-88zm0 120c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"}}]},name:"tag",theme:"outlined"};function v(){return v=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},v.apply(this,arguments)}const _=(t,a)=>l.createElement(y,v({},t,{ref:a,icon:T})),k=l.forwardRef(_);function V({category:t,score:a,color:r="#3B82F6",icon:n,variant:o="filled",size:h="md"}){const i="inline-flex items-center gap-1 rounded-full font-medium",p=h==="sm"?"px-2 py-0.5 text-xs":h==="lg"?"px-4 py-1.5 text-sm":"px-3 py-1 text-sm",d=o==="filled"?{backgroundColor:`${r}1A`,color:r,border:`1px solid ${r}33`}:o==="outline"?{backgroundColor:"transparent",color:r,border:`1px solid ${r}`}:{backgroundColor:"transparent",color:r,border:"1px solid transparent"};return e.jsxs("span",{className:`${i} ${p}`,style:d,title:a?`${a}`:void 0,children:[n&&e.jsx("span",{className:"text-current",children:n}),e.jsx("span",{children:t}),typeof a<"u"&&e.jsx("span",{className:"opacity-80",children:a})]})}const A=()=>{const t=M();return E({mutationFn:a=>q.deleteDocument(a),onSuccess:()=>{t.invalidateQueries({queryKey:["documents"]}),t.invalidateQueries({queryKey:["statistics"]})}})};function Q(t,a){const[r,n]=l.useState(t);return l.useEffect(()=>{const o=setTimeout(()=>{n(t)},a);return()=>{clearTimeout(o)}},[t,a]),r}function J(){const[t,a]=l.useState({query:"",category:"همه",source:"همه",page:1,limit:25}),[r,n]=l.useState(new Set),o=Q(t.query,300),h=l.useMemo(()=>({...t,query:o,category:t.category==="همه"?void 0:t.category,source:t.source==="همه"?void 0:t.source}),[t,o]),{data:i,isLoading:p}=I(h),{data:d}=O(),j=A(),m=(i==null?void 0:i.items)||[],u=i==null?void 0:i.pagination,w=async s=>{if(confirm("آیا از حذف این آیتم اطمینان دارید؟"))try{await j.mutateAsync(s)}catch(c){console.error("Error deleting item:",c)}},x=(s,c)=>{a(g=>({...g,[s]:c,page:1}))},S=s=>{n(c=>{const g=new Set(c);return g.has(s)?g.delete(s):g.add(s),g})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"داده‌های جمع‌آوری شده"}),e.jsx("p",{className:"text-gray-600",children:"جستجو و مدیریت اطلاعات حقوقی جمع‌آوری شده"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",style:{fontSize:"20px"}}),e.jsx("input",{type:"text",placeholder:"جستجو در عناوین...",value:t.query,onChange:s=>x("query",s.target.value),className:"w-full pr-10 pl-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{children:e.jsxs("select",{value:t.category,onChange:s=>x("category",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"همه",children:"همه دسته‌بندی‌ها"}),d&&Object.keys(d.categories).map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("div",{children:e.jsxs("select",{value:t.source,onChange:s=>x("source",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"همه",children:"همه منابع"}),d&&Object.keys(d.topDomains).map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("div",{children:e.jsxs("select",{value:t.limit,onChange:s=>x("limit",parseInt(s.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:25,children:"25 آیتم"}),e.jsx("option",{value:50,children:"50 آیتم"}),e.jsx("option",{value:100,children:"100 آیتم"})]})})]})}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(FileText,{size:20}),u&&e.jsxs("span",{children:["نمایش ",m.length.toLocaleString("fa-IR")," آیتم از ",u.totalItems.toLocaleString("fa-IR")," نتیجه"]})]})}),e.jsx("div",{className:"space-y-4",children:p?e.jsx("div",{className:"space-y-4",children:[...Array(t.limit)].map((s,c)=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]},c))}):m.length===0?e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[e.jsx(FileText,{size:48,className:"text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"هیچ آیتمی یافت نشد"}),e.jsx("p",{className:"text-gray-500",children:t.query?"جستجوی شما نتیجه‌ای نداشت":"هنوز آیتمی جمع‌آوری نشده است"})]}):m.map(s=>{const c=r.has(s.id);return e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{style:{fontSize:"14px"}}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-600 truncate max-w-48",children:s.domain})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{style:{fontSize:"14px"}}),e.jsx("span",{children:C(new Date(s.createdAt),"yyyy/MM/dd",{locale:$})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{style:{fontSize:"14px"}}),e.jsxs("span",{children:[(s.ratingScore*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"text-gray-400",children:[s.wordCount.toLocaleString("fa-IR")," کلمه"]})]}),e.jsx("div",{className:"flex items-center gap-2 mb-4",children:e.jsx(V,{category:s.category,icon:e.jsx(k,{style:{fontSize:"14px"}}),color:"#3B82F6",variant:"filled",size:"md"})}),e.jsxs("div",{className:"text-gray-700 leading-relaxed",children:[c?e.jsx("div",{className:"whitespace-pre-wrap",children:s.content}):e.jsxs("div",{children:[s.content.slice(0,300),s.content.length>300&&"..."]}),s.content.length>300&&e.jsx("button",{onClick:()=>S(s.id),className:"text-blue-600 hover:text-blue-700 font-medium text-sm mt-2",children:c?"نمایش کمتر":"نمایش بیشتر"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center w-10 h-10 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"مشاهده اصل",children:e.jsx(N,{style:{fontSize:"18px"}})}),e.jsx("button",{onClick:()=>w(s.id),className:"flex items-center justify-center w-10 h-10 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"حذف",disabled:j.isPending,children:e.jsx(B,{style:{fontSize:"18px"}})})]})]})},s.id)})}),u&&u.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[e.jsx("button",{onClick:()=>x("page",t.page-1),disabled:t.page===1,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg disabled:opacity-50",children:"قبلی"}),e.jsxs("span",{className:"text-gray-700",children:["صفحه ",t.page.toLocaleString("fa-IR")," از ",u.totalPages.toLocaleString("fa-IR")]}),e.jsx("button",{onClick:()=>x("page",t.page+1),disabled:t.page===u.totalPages,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg disabled:opacity-50",children:"بعدی"})]})]})}export{J as default};
