import{r as x,j as e,a as k,b as w,f as C,c as S,d as q,e as L}from"./index-DFIyXlnM.js";import{u as I}from"./useMutation-B-WHVmSL.js";var M={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const z=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),y=(t,a)=>{const r=x.forwardRef(({color:o="currentColor",size:n=24,strokeWidth:u=2,absoluteStrokeWidth:l,children:g,...c},b)=>x.createElement("svg",{ref:b,...M,width:n,height:n,stroke:o,strokeWidth:l?Number(u)*24/Number(n):u,className:`lucide lucide-${z(t)}`,...c},[...a.map(([m,d])=>x.createElement(m,d)),...(Array.isArray(g)?g:[g])||[]]));return r.displayName=`${t}`,r},E=y("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),j=y("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),f=y("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),$=y("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),F=y("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),A=y("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),R=y("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function T({category:t,score:a,color:r="#3B82F6",icon:o,variant:n="filled",size:u="md"}){const l="inline-flex items-center gap-1 rounded-full font-medium",g=u==="sm"?"px-2 py-0.5 text-xs":u==="lg"?"px-4 py-1.5 text-sm":"px-3 py-1 text-sm",c=n==="filled"?{backgroundColor:`${r}1A`,color:r,border:`1px solid ${r}33`}:n==="outline"?{backgroundColor:"transparent",color:r,border:`1px solid ${r}`}:{backgroundColor:"transparent",color:r,border:"1px solid transparent"};return e.jsxs("span",{className:`${l} ${g}`,style:c,title:a?`${a}`:void 0,children:[o&&e.jsx("span",{className:"text-current",children:o}),e.jsx("span",{children:t}),typeof a<"u"&&e.jsx("span",{className:"opacity-80",children:a})]})}const D=()=>{const t=S();return I({mutationFn:a=>q.deleteDocument(a),onSuccess:()=>{t.invalidateQueries({queryKey:["documents"]}),t.invalidateQueries({queryKey:["statistics"]})}})};function V(t,a){const[r,o]=x.useState(t);return x.useEffect(()=>{const n=setTimeout(()=>{o(t)},a);return()=>{clearTimeout(n)}},[t,a]),r}function H(){const[t,a]=x.useState({query:"",category:"همه",source:"همه",page:1,limit:25}),[r,o]=x.useState(new Set),n=V(t.query,300),u=x.useMemo(()=>({...t,query:n,category:t.category==="همه"?void 0:t.category,source:t.source==="همه"?void 0:t.source}),[t,n]),{data:l,isLoading:g}=k(u),{data:c}=w(),b=D(),m=(l==null?void 0:l.items)||[],d=l==null?void 0:l.pagination,v=async s=>{if(confirm("آیا از حذف این آیتم اطمینان دارید؟"))try{await b.mutateAsync(s)}catch(i){console.error("Error deleting item:",i)}},p=(s,i)=>{a(h=>({...h,[s]:i,page:1}))},N=s=>{o(i=>{const h=new Set(i);return h.has(s)?h.delete(s):h.add(s),h})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"داده‌های جمع‌آوری شده"}),e.jsx("p",{className:"text-gray-600",children:"جستجو و مدیریت اطلاعات حقوقی جمع‌آوری شده"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"جستجو در عناوین...",value:t.query,onChange:s=>p("query",s.target.value),className:"w-full pr-10 pl-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{children:e.jsxs("select",{value:t.category,onChange:s=>p("category",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"همه",children:"همه دسته‌بندی‌ها"}),c&&Object.keys(c.categories).map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("div",{children:e.jsxs("select",{value:t.source,onChange:s=>p("source",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"همه",children:"همه منابع"}),c&&Object.keys(c.topDomains).map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("div",{children:e.jsxs("select",{value:t.limit,onChange:s=>p("limit",parseInt(s.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:25,children:"25 آیتم"}),e.jsx("option",{value:50,children:"50 آیتم"}),e.jsx("option",{value:100,children:"100 آیتم"})]})})]})}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(f,{size:20}),d&&e.jsxs("span",{children:["نمایش ",m.length.toLocaleString("fa-IR")," آیتم از ",d.totalItems.toLocaleString("fa-IR")," نتیجه"]})]})}),e.jsx("div",{className:"space-y-4",children:g?e.jsx("div",{className:"space-y-4",children:[...Array(t.limit)].map((s,i)=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]},i))}):m.length===0?e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[e.jsx(f,{size:48,className:"text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"هیچ آیتمی یافت نشد"}),e.jsx("p",{className:"text-gray-500",children:t.query?"جستجوی شما نتیجه‌ای نداشت":"هنوز آیتمی جمع‌آوری نشده است"})]}):m.map(s=>{const i=r.has(s.id);return e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{size:14}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-600 truncate max-w-48",children:s.domain})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{size:14}),e.jsx("span",{children:C(new Date(s.createdAt),"yyyy/MM/dd",{locale:L})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{size:14}),e.jsxs("span",{children:[(s.ratingScore*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"text-gray-400",children:[s.wordCount.toLocaleString("fa-IR")," کلمه"]})]}),e.jsx("div",{className:"flex items-center gap-2 mb-4",children:e.jsx(T,{category:s.category,icon:e.jsx(A,{size:14}),color:"#3B82F6",variant:"filled",size:"md"})}),e.jsxs("div",{className:"text-gray-700 leading-relaxed",children:[i?e.jsx("div",{className:"whitespace-pre-wrap",children:s.content}):e.jsxs("div",{children:[s.content.slice(0,300),s.content.length>300&&"..."]}),s.content.length>300&&e.jsx("button",{onClick:()=>N(s.id),className:"text-blue-600 hover:text-blue-700 font-medium text-sm mt-2",children:i?"نمایش کمتر":"نمایش بیشتر"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center w-10 h-10 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"مشاهده اصل",children:e.jsx(j,{size:18})}),e.jsx("button",{onClick:()=>v(s.id),className:"flex items-center justify-center w-10 h-10 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"حذف",disabled:b.isPending,children:e.jsx(R,{size:18})})]})]})},s.id)})}),d&&d.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[e.jsx("button",{onClick:()=>p("page",t.page-1),disabled:t.page===1,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg disabled:opacity-50",children:"قبلی"}),e.jsxs("span",{className:"text-gray-700",children:["صفحه ",t.page.toLocaleString("fa-IR")," از ",d.totalPages.toLocaleString("fa-IR")]}),e.jsx("button",{onClick:()=>p("page",t.page+1),disabled:t.page===d.totalPages,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg disabled:opacity-50",children:"بعدی"})]})]})}export{H as default};
